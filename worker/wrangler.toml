name = "cms"
main = "src/index.ts"
compatibility_date = "2025-04-21"

# =============================================================================
# Default Configuration (Production)
# This is what gets deployed with `wrangler deploy`
# =============================================================================

[[d1_databases]]
binding = "DB"
database_name = "cms-db"
database_id = "e425276a-525d-41d5-bc6a-9e2c17744ef5"
migrations_dir = "migrations/sql"

[[r2_buckets]]
binding = "BUCKET"
bucket_name = "cms-media"

[[durable_objects.bindings]]
name = "WEBSOCKET_HANDLER"
class_name = "WebSocketHandler"

[[migrations]]
tag = "v1"
new_classes = ["WebSocketHandler"]

[observability.logs]
enabled = true

# =============================================================================
# Local Development Configuration
# Used with `wrangler dev` - uses local SQLite and dev bucket
# =============================================================================
[env.dev]

[[env.dev.d1_databases]]
binding = "DB"
database_name = "cms-db-dev"
database_id = "local-dev-placeholder"

[[env.dev.r2_buckets]]
binding = "BUCKET"
bucket_name = "cms-media-dev"

[[env.dev.durable_objects.bindings]]
name = "WEBSOCKET_HANDLER"
class_name = "WebSocketHandler"

# =============================================================================
# Dev server settings (applies to `wrangler dev`)
# =============================================================================
[dev]
port = 8787
local_protocol = "http"
ip = "localhost"

